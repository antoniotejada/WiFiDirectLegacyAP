# WiFiDirectLegacyAP

Python port of https://github.com/microsoft/windows-classic-samples/tree/main/Samples/WiFiDirectLegacyAP

Creates a WiFi local access point other devices can join. 

The access point hardware adapter needs WiFiDirect support (common) but not hosted network support (extremely uncommon).

Note the internet connection, if any, on the acces point is not shared with the clients, therefore the access point is not shut down when there's no internet connection (which happens on regular Windows 10 access points unless a certain registry setting is set).

See https://github.com/govert/WiFiDirectLegacyAPDemo and https://learn.microsoft.com/en-us/windows-hardware/drivers/partnerapps/wi-fi-direct for more information

## Features
- Hooks Python into winrt
- Creates a local access point using WiFiDirect APIs

## Requirements
- WiFiDirect supported WiFi hardware (most)
- Windows 10
- Python 2.7
- comtypes

## Usage

1. Fill _out\ssid_password.txt with two lines containing the ssid and the password or run without and it will use the default autogenerated ssid and password which will be output to the standard output
1. Run WiFiLegacyAP.py
```bat
>WiFiDirectLegacyAP.py
2023-08-29 21:49:55,394 WARNING:WiFiDirectLegacyAP.py(2383):[24780] winrt_wifi: Error reading _out\ssid_password.txt, will use random ssid and password
Sleeping forever, ssid 'DIRECT-DNXXXXXXXXRXPT' password 'IJLIZGOT ' press ctrl+c to finish
```
## Related Projects
- https://github.com/govert/WiFiDirectLegacyAPDemo
- https://github.com/gerfen/WiFiDirectLegacyAPCSharp
- https://github.com/zig13/WifiDirectLegacySurplex
- https://github.com/spieglt/wifidirect-legacy-ap

## TODO
- Cleanup code
    - Use generated code from .idl instead of manually typing comtypes
    - Move winrt functionality to wrttypes
- Cleanup documentation
- Add the rest of functionality 
    - Console
    - Endpoint logging
    - Disconnect event handlers